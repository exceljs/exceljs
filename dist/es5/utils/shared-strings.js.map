{"version":3,"sources":["../../../lib/utils/shared-strings.js"],"names":["SharedStrings","module","exports","_values","_totalRefs","_hash","prototype","count","length","values","totalRefs","getString","index","add","value","undefined","push"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,gBAAgBC,OAAOC,OAAP,GAAiB,YAAW;AAC9C,OAAKC,OAAL,GAAe,EAAf;AACA,OAAKC,UAAL,GAAkB,CAAlB;AACA,OAAKC,KAAL,GAAa,EAAb;AACD,CAJD;;AAMAL,cAAcM,SAAd,GAA0B;AACxB,MAAIC,KAAJ,GAAY;AACV,WAAO,KAAKJ,OAAL,CAAaK,MAApB;AACD,GAHuB;AAIxB,MAAIC,MAAJ,GAAa;AACX,WAAO,KAAKN,OAAZ;AACD,GANuB;AAOxB,MAAIO,SAAJ,GAAgB;AACd,WAAO,KAAKN,UAAZ;AACD,GATuB;;AAWxBO,aAAW,mBAASC,KAAT,EAAgB;AACzB,WAAO,KAAKT,OAAL,CAAaS,KAAb,CAAP;AACD,GAbuB;;AAexBC,OAAK,aAASC,KAAT,EAAgB;AACnB,QAAIF,QAAQ,KAAKP,KAAL,CAAWS,KAAX,CAAZ;AACA,QAAIF,UAAUG,SAAd,EAAyB;AACvBH,cAAQ,KAAKP,KAAL,CAAWS,KAAX,IAAoB,KAAKX,OAAL,CAAaK,MAAzC;AACA,WAAKL,OAAL,CAAaa,IAAb,CAAkBF,KAAlB;AACD;AACD,SAAKV,UAAL;AACA,WAAOQ,KAAP;AACD;AAvBuB,CAA1B","file":"shared-strings.js","sourcesContent":["/**\n * Copyright (c) 2015-2017 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar SharedStrings = module.exports = function() {\n  this._values = [];\n  this._totalRefs = 0;\n  this._hash = {};\n};\n\nSharedStrings.prototype = {\n  get count() {\n    return this._values.length;\n  },\n  get values() {\n    return this._values;\n  },\n  get totalRefs() {\n    return this._totalRefs;\n  },\n\n  getString: function(index) {\n    return this._values[index];\n  },\n\n  add: function(value) {\n    var index = this._hash[value];\n    if (index === undefined) {\n      index = this._hash[value] = this._values.length;\n      this._values.push(value);\n    }\n    this._totalRefs++;\n    return index;\n  }\n};\n"]}