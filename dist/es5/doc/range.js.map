{"version":3,"sources":["../../../lib/doc/range.js"],"names":["colCache","require","Range","module","exports","decode","arguments","prototype","_set_tlbr","t","l","b","r","s","model","top","Math","min","left","bottom","max","right","sheetName","_set_tl_br","tl","br","decodeAddress","row","col","argv","length","value","Array","tlbr","decodeEx","Error","_serialisedSheetName","test","expand","expandRow","dimensions","number","expandToAddress","addressStr","address","n2l","$t$l","$b$r","range","$range","shortRange","count","$shortRange","toString","intersects","other","contains","containsEx"],"mappings":"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","file":"range.js","sourcesContent":["/**\n * Copyright (c) 2014-2017 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar colCache = require('./../utils/col-cache');\n\n// used by worksheet to calculate sheet dimensions\nvar Range = module.exports = function() {\n  this.decode(arguments);\n};\n\nRange.prototype = {\n  _set_tlbr: function(t, l, b, r, s) {\n    this.model = {\n      top: Math.min(t, b),\n      left: Math.min(l, r),\n      bottom: Math.max(t, b),\n      right: Math.max(l, r),\n      sheetName: s\n    };\n  },\n  _set_tl_br: function(tl, br, s) {\n    tl = colCache.decodeAddress(tl);\n    br = colCache.decodeAddress(br);\n    this._set_tlbr(tl.row, tl.col, br.row, br.col, s);\n  },\n  decode: function(argv) {\n    switch (argv.length) {\n      case 5: // [t,l,b,r,s]\n        this._set_tlbr(argv[0], argv[1], argv[2], argv[3], argv[4]);\n        break;\n      case 4: // [t,l,b,r]\n        this._set_tlbr(argv[0], argv[1], argv[2], argv[3]);\n        break;\n\n      case 3: // [tl,br,s]\n        this._set_tl_br(argv[0], argv[1], argv[2]);\n        break;\n      case 2: // [tl,br]\n        this._set_tl_br(argv[0], argv[1]);\n        break;\n\n      case 1:\n        var value = argv[0];\n        if (value instanceof Range) { // copy constructor\n          this.model = {\n            top: value.model.top,\n            left: value.model.left,\n            bottom: value.model.bottom,\n            right: value.model.right,\n            sheetName: value.sheetName\n          };\n        } else if (value instanceof Array) { // an arguments array\n          this.decode(value);\n        } else if (value.top && value.left && value.bottom && value.right) { // a model\n          this.model = {\n            top: value.top,\n            left: value.left,\n            bottom: value.bottom,\n            right: value.right,\n            sheetName: value.sheetName\n          };\n        } else { // [sheetName!]tl:br\n          var tlbr = colCache.decodeEx(value);\n          if (tlbr.top) {\n            this.model = {\n              top: tlbr.top,\n              left: tlbr.left,\n              bottom: tlbr.bottom,\n              right: tlbr.right,\n              sheetName: tlbr.sheetName\n            };\n          } else {\n            this.model = {\n              top: tlbr.row,\n              left: tlbr.col,\n              bottom: tlbr.row,\n              right: tlbr.col,\n              sheetName: tlbr.sheetName\n            };\n          }\n        }\n        break;\n\n      case 0:\n        this.model = {\n          top: 0,\n          left: 0,\n          bottom: 0,\n          right: 0\n        };\n        break;\n\n      default:\n        throw new Error('Invalid number of arguments to _getDimensions() - ' + argv.length);\n    }\n  },\n\n  get top() { return this.model.top || 1; },\n  set top(value) { this.model.top = value; },\n  get left() { return this.model.left || 1; },\n  set left(value) { this.model.left = value; },\n  get bottom() { return this.model.bottom || 1; },\n  set bottom(value) { this.model.bottom = value; },\n  get right() { return this.model.right || 1; },\n  set right(value) { this.model.right = value; },\n  get sheetName() { return this.model.sheetName; },\n  set sheetName(value) { this.model.sheetName = value; },\n\n  get _serialisedSheetName() {\n    var sheetName = this.model.sheetName;\n    if (sheetName) {\n      if (/^[a-zA-Z0-9]*$/.test(sheetName)) {\n        return sheetName + '!';\n      }\n      return '\\'' + sheetName + '\\'!';\n    }\n    return '';\n  },\n\n  expand: function(top, left, bottom, right) {\n    if (!this.model.top || (top < this.top)) this.top = top;\n    if (!this.model.left || (left < this.left)) this.left = left;\n    if (!this.model.bottom || (bottom > this.bottom)) this.bottom = bottom;\n    if (!this.model.right || (right > this.right)) this.right = right;\n  },\n  expandRow: function(row) {\n    if (row) {\n      var dimensions = row.dimensions;\n      if (dimensions) {\n        this.expand(row.number, dimensions.min, row.number, dimensions.max);\n      }\n    }\n  },\n  expandToAddress: function(addressStr) {\n    var address = colCache.decodeEx(addressStr);\n    this.expand(address.row, address.col, address.row, address.col);\n  },\n\n  get tl() {\n    return colCache.n2l(this.left) + this.top;\n  },\n  get $t$l() {\n    return '$' + colCache.n2l(this.left) + '$' + this.top;\n  },\n  get br() {\n    return colCache.n2l(this.right) + this.bottom;\n  },\n  get $b$r() {\n    return '$' + colCache.n2l(this.right) + '$' + this.bottom;\n  },\n\n  get range() {\n    return this._serialisedSheetName + this.tl + ':' + this.br;\n  },\n  get $range() {\n    return this._serialisedSheetName + this.$t$l + ':' + this.$b$r;\n  },\n  get shortRange() {\n    return this.count > 1 ? this.range :\n      (this._serialisedSheetName + this.tl);\n  },\n  get $shortRange() {\n    return this.count > 1 ? this.$range :\n      (this._serialisedSheetName + this.$t$l);\n  },\n  get count() {\n    return ((1 + this.bottom) - this.top) * ((1 + this.right) - this.left);\n  },\n\n  toString: function() {\n    return this.range;\n  },\n\n  intersects: function(other) {\n    if (other.sheetName && this.sheetName && (other.sheetName !== this.sheetName)) return false;\n    if (other.bottom < this.top) return false;\n    if (other.top > this.bottom) return false;\n    if (other.right < this.left) return false;\n    if (other.left > this.right) return false;\n    return true;\n  },\n  contains: function(addressStr) {\n    var address = colCache.decodeEx(addressStr);\n    return this.containsEx(address);\n  },\n  containsEx: function(address) {\n    if (address.sheetName && this.sheetName && (address.sheetName !== this.sheetName)) return false;\n    return (address.row >= this.top) &&\n           (address.row <= this.bottom) &&\n           (address.col >= this.left) &&\n           (address.col <= this.right);\n  }\n};\n"]}