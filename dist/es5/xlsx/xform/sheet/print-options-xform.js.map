{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/print-options-xform.js"],"names":["_","require","utils","BaseXform","booleanToXml","model","undefined","PrintOptionsXform","module","exports","inherits","tag","render","xmlStream","attributes","headings","showRowColHeaders","gridLines","showGridLines","horizontalCentered","verticalCentered","some","value","leafNode","parseOpen","node","name","parseText","parseClose"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,IAAIC,QAAQ,2BAAR,CAAR;AACA,IAAIC,QAAQD,QAAQ,sBAAR,CAAZ;AACA,IAAIE,YAAYF,QAAQ,eAAR,CAAhB;;AAEA,SAASG,YAAT,CAAsBC,KAAtB,EAA6B;AAC3B,SAAOA,QAAQ,GAAR,GAAcC,SAArB;AACD;;AAED,IAAIC,oBAAoBC,OAAOC,OAAP,GAAiB,YAAW,CACnD,CADD;;AAGAP,MAAMQ,QAAN,CAAeH,iBAAf,EAAkCJ,SAAlC,EAA6C;;AAE3C,MAAIQ,GAAJ,GAAU;AAAE,WAAO,cAAP;AAAwB,GAFO;;AAI3CC,UAAQ,gBAASC,SAAT,EAAoBR,KAApB,EAA2B;AACjC,QAAIA,KAAJ,EAAW;AACT,UAAIS,aAAa;AACfC,kBAAUX,aAAaC,MAAMW,iBAAnB,CADK;AAEfC,mBAAWb,aAAaC,MAAMa,aAAnB,CAFI;AAGfC,4BAAoBf,aAAaC,MAAMc,kBAAnB,CAHL;AAIfC,0BAAkBhB,aAAaC,MAAMe,gBAAnB;AAJH,OAAjB;AAMA,UAAIpB,EAAEqB,IAAF,CAAOP,UAAP,EAAmB,UAASQ,KAAT,EAAgB;AACnC,eAAOA,UAAUhB,SAAjB;AACD,OAFC,CAAJ,EAEM;AACJO,kBAAUU,QAAV,CAAmB,KAAKZ,GAAxB,EAA6BG,UAA7B;AACD;AACF;AACF,GAlB0C;;AAoB3CU,aAAW,mBAASC,IAAT,EAAe;AACxB,YAAQA,KAAKC,IAAb;AACE,WAAK,KAAKf,GAAV;AACE,aAAKN,KAAL,GAAa;AACXW,6BAAmBS,KAAKX,UAAL,CAAgBC,QAAhB,KAA6B,GADrC;AAEXG,yBAAeO,KAAKX,UAAL,CAAgBG,SAAhB,KAA8B,GAFlC;AAGXE,8BAAoBM,KAAKX,UAAL,CAAgBK,kBAAhB,KAAuC,GAHhD;AAIXC,4BAAkBK,KAAKX,UAAL,CAAgBM,gBAAhB,KAAqC;AAJ5C,SAAb;AAMA,eAAO,IAAP;AACF;AACE,eAAO,KAAP;AAVJ;AAYD,GAjC0C;AAkC3CO,aAAW,qBAAW,CACrB,CAnC0C;AAoC3CC,cAAY,sBAAW;AACrB,WAAO,KAAP;AACD;AAtC0C,CAA7C","file":"print-options-xform.js","sourcesContent":["/**\n * Copyright (c) 2016 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar _ = require('../../../utils/under-dash');\nvar utils = require('../../../utils/utils');\nvar BaseXform = require('../base-xform');\n\nfunction booleanToXml(model) {\n  return model ? '1' : undefined;\n}\n\nvar PrintOptionsXform = module.exports = function() {\n};\n\nutils.inherits(PrintOptionsXform, BaseXform, {\n\n  get tag() { return 'printOptions'; },\n\n  render: function(xmlStream, model) {\n    if (model) {\n      var attributes = {\n        headings: booleanToXml(model.showRowColHeaders),\n        gridLines: booleanToXml(model.showGridLines),\n        horizontalCentered: booleanToXml(model.horizontalCentered),\n        verticalCentered: booleanToXml(model.verticalCentered)\n      };\n      if (_.some(attributes, function(value) {\n          return value !== undefined;\n        })) {\n        xmlStream.leafNode(this.tag, attributes);\n      }\n    }\n  },\n  \n  parseOpen: function(node) {\n    switch (node.name) {\n      case this.tag:\n        this.model = {\n          showRowColHeaders: node.attributes.headings === '1',\n          showGridLines: node.attributes.gridLines === '1',\n          horizontalCentered: node.attributes.horizontalCentered === '1',\n          verticalCentered: node.attributes.verticalCentered === '1'\n        };\n        return true;\n      default:\n        return false;\n    }\n  },\n  parseText: function() {\n  },\n  parseClose: function() {\n    return false;\n  }\n});\n"]}