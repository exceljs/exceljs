{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/page-margins-xform.js"],"names":["_","require","utils","BaseXform","PageMarginsXform","module","exports","inherits","tag","render","xmlStream","model","attributes","left","right","top","bottom","header","footer","some","value","undefined","leafNode","parseOpen","node","name","parseFloat","parseText","parseClose"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,IAAIC,QAAQ,2BAAR,CAAR;AACA,IAAIC,QAAQD,QAAQ,sBAAR,CAAZ;AACA,IAAIE,YAAYF,QAAQ,eAAR,CAAhB;;AAEA,IAAIG,mBAAmBC,OAAOC,OAAP,GAAiB,YAAW,CAClD,CADD;;AAGAJ,MAAMK,QAAN,CAAeH,gBAAf,EAAiCD,SAAjC,EAA4C;;AAE1C,MAAIK,GAAJ,GAAU;AAAE,WAAO,aAAP;AAAuB,GAFO;;AAI1CC,UAAQ,gBAASC,SAAT,EAAoBC,KAApB,EAA2B;AACjC,QAAIA,KAAJ,EAAW;AACT,UAAIC,aAAa;AACfC,cAAMF,MAAME,IADG;AAEfC,eAAOH,MAAMG,KAFE;AAGfC,aAAKJ,MAAMI,GAHI;AAIfC,gBAAQL,MAAMK,MAJC;AAKfC,gBAAQN,MAAMM,MALC;AAMfC,gBAAQP,MAAMO;AANC,OAAjB;AAQA,UAAIlB,EAAEmB,IAAF,CAAOP,UAAP,EAAmB,UAASQ,KAAT,EAAgB;AAAE,eAAOA,UAAUC,SAAjB;AAA6B,OAAlE,CAAJ,EAAyE;AACvEX,kBAAUY,QAAV,CAAmB,KAAKd,GAAxB,EAA6BI,UAA7B;AACD;AACF;AACF,GAlByC;;AAoB1CW,aAAW,mBAASC,IAAT,EAAe;AACxB,YAAQA,KAAKC,IAAb;AACE,WAAK,KAAKjB,GAAV;AACE,aAAKG,KAAL,GAAa;AACXE,gBAAMa,WAAWF,KAAKZ,UAAL,CAAgBC,IAAhB,IAAwB,GAAnC,CADK;AAEXC,iBAAOY,WAAWF,KAAKZ,UAAL,CAAgBE,KAAhB,IAAyB,GAApC,CAFI;AAGXC,eAAKW,WAAWF,KAAKZ,UAAL,CAAgBG,GAAhB,IAAuB,IAAlC,CAHM;AAIXC,kBAAQU,WAAWF,KAAKZ,UAAL,CAAgBI,MAAhB,IAA0B,IAArC,CAJG;AAKXC,kBAAQS,WAAWF,KAAKZ,UAAL,CAAgBK,MAAhB,IAA0B,GAArC,CALG;AAMXC,kBAAQQ,WAAWF,KAAKZ,UAAL,CAAgBM,MAAhB,IAA0B,GAArC;AANG,SAAb;AAQA,eAAO,IAAP;AACF;AACE,eAAO,KAAP;AAZJ;AAcD,GAnCyC;AAoC1CS,aAAW,qBAAW,CACrB,CArCyC;AAsC1CC,cAAY,sBAAW;AACrB,WAAO,KAAP;AACD;AAxCyC,CAA5C","file":"page-margins-xform.js","sourcesContent":["/**\n * Copyright (c) 2016 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar _ = require('../../../utils/under-dash');\nvar utils = require('../../../utils/utils');\nvar BaseXform = require('../base-xform');\n\nvar PageMarginsXform = module.exports = function() {\n};\n\nutils.inherits(PageMarginsXform, BaseXform, {\n\n  get tag() { return 'pageMargins'; },\n\n  render: function(xmlStream, model) {\n    if (model) {\n      var attributes = {\n        left: model.left,\n        right: model.right,\n        top: model.top,\n        bottom: model.bottom,\n        header: model.header,\n        footer: model.footer\n      };\n      if (_.some(attributes, function(value) { return value !== undefined; })) {\n        xmlStream.leafNode(this.tag, attributes);\n      }\n    }\n  },\n  \n  parseOpen: function(node) {\n    switch (node.name) {\n      case this.tag:\n        this.model = {\n          left: parseFloat(node.attributes.left || 0.7),\n          right: parseFloat(node.attributes.right || 0.7),\n          top: parseFloat(node.attributes.top || 0.75),\n          bottom: parseFloat(node.attributes.bottom || 0.75),\n          header: parseFloat(node.attributes.header || 0.3),\n          footer: parseFloat(node.attributes.footer || 0.3)\n        };\n        return true;\n      default:\n        return false;\n    }\n  },\n  parseText: function() {\n  },\n  parseClose: function() {\n    return false;\n  }\n});\n"]}