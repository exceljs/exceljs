{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/col-xform.js"],"names":["utils","require","BaseXform","ColXform","module","exports","inherits","tag","prepare","model","options","styleId","styles","addStyleModel","style","render","xmlStream","openNode","addAttribute","min","max","width","hidden","bestFit","outlineLevel","collapsed","closeNode","parseOpen","node","name","parseInt","attributes","undefined","parseFloat","parseText","parseClose","reconcile","getStyleModel"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,QAAQC,QAAQ,sBAAR,CAAZ;AACA,IAAIC,YAAYD,QAAQ,eAAR,CAAhB;;AAEA,IAAIE,WAAWC,OAAOC,OAAP,GAAiB,YAAW,CAC1C,CADD;;AAGAL,MAAMM,QAAN,CAAeH,QAAf,EAAyBD,SAAzB,EAAoC;;AAElC,MAAIK,GAAJ,GAAU;AAAE,WAAO,KAAP;AAAe,GAFO;;AAIlCC,WAAS,iBAASC,KAAT,EAAgBC,OAAhB,EAAyB;AAChC,QAAIC,UAAUD,QAAQE,MAAR,CAAeC,aAAf,CAA6BJ,MAAMK,KAAN,IAAe,EAA5C,CAAd;AACA,QAAIH,OAAJ,EAAa;AACXF,YAAME,OAAN,GAAgBA,OAAhB;AACD;AACF,GATiC;;AAWlCI,UAAQ,gBAASC,SAAT,EAAoBP,KAApB,EAA2B;AACjCO,cAAUC,QAAV,CAAmB,KAAnB;AACAD,cAAUE,YAAV,CAAuB,KAAvB,EAA8BT,MAAMU,GAApC;AACAH,cAAUE,YAAV,CAAuB,KAAvB,EAA8BT,MAAMW,GAApC;AACA,QAAIX,MAAMY,KAAV,EAAiB;AACfL,gBAAUE,YAAV,CAAuB,OAAvB,EAAgCT,MAAMY,KAAtC;AACD;AACD,QAAIZ,MAAME,OAAV,EAAmB;AACjBK,gBAAUE,YAAV,CAAuB,OAAvB,EAAgCT,MAAME,OAAtC;AACD;AACD,QAAIF,MAAMa,MAAV,EAAkB;AAChBN,gBAAUE,YAAV,CAAuB,QAAvB,EAAiC,GAAjC;AACD;AACD,QAAIT,MAAMc,OAAV,EAAmB;AACjBP,gBAAUE,YAAV,CAAuB,SAAvB,EAAkC,GAAlC;AACD;AACD,QAAIT,MAAMe,YAAV,EAAwB;AACtBR,gBAAUE,YAAV,CAAuB,cAAvB,EAAuCT,MAAMe,YAA7C;AACD;AACD,QAAIf,MAAMgB,SAAV,EAAqB;AACnBT,gBAAUE,YAAV,CAAuB,WAAvB,EAAoC,GAApC;AACD;AACDF,cAAUE,YAAV,CAAuB,aAAvB,EAAsC,GAAtC;AACAF,cAAUU,SAAV;AACD,GAnCiC;;AAqClCC,aAAW,mBAASC,IAAT,EAAe;AACxB,QAAIA,KAAKC,IAAL,KAAc,KAAlB,EAAyB;AACvB,UAAIpB,QAAQ,KAAKA,KAAL,GAAa;AACvBU,aAAKW,SAASF,KAAKG,UAAL,CAAgBZ,GAAhB,IAAuB,GAAhC,EAAqC,EAArC,CADkB;AAEvBC,aAAKU,SAASF,KAAKG,UAAL,CAAgBX,GAAhB,IAAuB,GAAhC,EAAqC,EAArC,CAFkB;AAGvBC,eAAOO,KAAKG,UAAL,CAAgBV,KAAhB,KAA0BW,SAA1B,GAAsCA,SAAtC,GAAkDC,WAAWL,KAAKG,UAAL,CAAgBV,KAAhB,IAAyB,GAApC;AAHlC,OAAzB;AAKA,UAAIO,KAAKG,UAAL,CAAgBjB,KAApB,EAA2B;AACzBL,cAAME,OAAN,GAAgBmB,SAASF,KAAKG,UAAL,CAAgBjB,KAAzB,EAAgC,EAAhC,CAAhB;AACD;AACD,UAAIc,KAAKG,UAAL,CAAgBT,MAApB,EAA4B;AAC1Bb,cAAMa,MAAN,GAAe,IAAf;AACD;AACD,UAAIM,KAAKG,UAAL,CAAgBR,OAApB,EAA6B;AAC3Bd,cAAMc,OAAN,GAAgB,IAAhB;AACD;AACD,UAAIK,KAAKG,UAAL,CAAgBP,YAApB,EAAkC;AAChCf,cAAMe,YAAN,GAAqBM,SAASF,KAAKG,UAAL,CAAgBP,YAAzB,EAAuC,EAAvC,CAArB;AACD;AACD,UAAII,KAAKG,UAAL,CAAgBN,SAApB,EAA+B;AAC7BhB,cAAMgB,SAAN,GAAkB,IAAlB;AACD;AACD,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD,GA9DiC;AA+DlCS,aAAW,qBAAW,CACrB,CAhEiC;AAiElCC,cAAY,sBAAW;AACrB,WAAO,KAAP;AACD,GAnEiC;;AAqElCC,aAAW,mBAAS3B,KAAT,EAAgBC,OAAhB,EAAyB;AAClC;AACA,QAAID,MAAME,OAAV,EAAmB;AACjBF,YAAMK,KAAN,GAAcJ,QAAQE,MAAR,CAAeyB,aAAf,CAA6B5B,MAAME,OAAnC,CAAd;AACD;AACF;AA1EiC,CAApC","file":"col-xform.js","sourcesContent":["/**\n * Copyright (c) 2015 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar utils = require('../../../utils/utils');\nvar BaseXform = require('../base-xform');\n\nvar ColXform = module.exports = function() {\n};\n\nutils.inherits(ColXform, BaseXform, {\n\n  get tag() { return 'col'; },\n\n  prepare: function(model, options) {\n    var styleId = options.styles.addStyleModel(model.style || {});\n    if (styleId) {\n      model.styleId = styleId;\n    }\n  },\n\n  render: function(xmlStream, model) {\n    xmlStream.openNode('col');\n    xmlStream.addAttribute('min', model.min);\n    xmlStream.addAttribute('max', model.max);\n    if (model.width) {\n      xmlStream.addAttribute('width', model.width);\n    }\n    if (model.styleId) {\n      xmlStream.addAttribute('style', model.styleId);\n    }\n    if (model.hidden) {\n      xmlStream.addAttribute('hidden', '1');\n    }\n    if (model.bestFit) {\n      xmlStream.addAttribute('bestFit', '1');\n    }\n    if (model.outlineLevel) {\n      xmlStream.addAttribute('outlineLevel', model.outlineLevel);\n    }\n    if (model.collapsed) {\n      xmlStream.addAttribute('collapsed', '1');\n    }\n    xmlStream.addAttribute('customWidth', '1');\n    xmlStream.closeNode();\n  },\n\n  parseOpen: function(node) {\n    if (node.name === 'col') {\n      var model = this.model = {\n        min: parseInt(node.attributes.min || '0', 10),\n        max: parseInt(node.attributes.max || '0', 10),\n        width: node.attributes.width === undefined ? undefined : parseFloat(node.attributes.width || '0')\n      };\n      if (node.attributes.style) {\n        model.styleId = parseInt(node.attributes.style, 10);\n      }\n      if (node.attributes.hidden) {\n        model.hidden = true;\n      }\n      if (node.attributes.bestFit) {\n        model.bestFit = true;\n      }\n      if (node.attributes.outlineLevel) {\n        model.outlineLevel = parseInt(node.attributes.outlineLevel, 10);\n      }\n      if (node.attributes.collapsed) {\n        model.collapsed = true;\n      }\n      return true;\n    }\n    return false;\n  },\n  parseText: function() {\n  },\n  parseClose: function() {\n    return false;\n  },\n\n  reconcile: function(model, options) {\n    // reconcile column styles\n    if (model.styleId) {\n      model.style = options.styles.getStyleModel(model.styleId);\n    }\n  }\n});\n"]}