{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/sheet-format-properties-xform.js"],"names":["_","require","utils","BaseXform","SheetFormatPropertiesXform","module","exports","inherits","tag","render","xmlStream","model","attributes","defaultRowHeight","outlineLevelRow","outlineLevelCol","dyDescent","some","value","undefined","leafNode","parseOpen","node","name","parseFloat","parseInt","parseText","parseClose"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,IAAIC,QAAQ,2BAAR,CAAR;AACA,IAAIC,QAAQD,QAAQ,sBAAR,CAAZ;AACA,IAAIE,YAAYF,QAAQ,eAAR,CAAhB;;AAEA,IAAIG,6BAA6BC,OAAOC,OAAP,GAAiB,YAAW,CAC5D,CADD;;AAGAJ,MAAMK,QAAN,CAAeH,0BAAf,EAA2CD,SAA3C,EAAsD;;AAEpD,MAAIK,GAAJ,GAAU;AAAE,WAAO,eAAP;AAAyB,GAFe;;AAIpDC,UAAQ,gBAASC,SAAT,EAAoBC,KAApB,EAA2B;AACjC,QAAIA,KAAJ,EAAW;AACT,UAAIC,aAAa;AACfC,0BAAkBF,MAAME,gBADT;AAEfC,yBAAiBH,MAAMG,eAFR;AAGfC,yBAAiBJ,MAAMI,eAHR;AAIf,2BAAmBJ,MAAMK;AAJV,OAAjB;AAMA,UAAIhB,EAAEiB,IAAF,CAAOL,UAAP,EAAmB,UAASM,KAAT,EAAgB;AAAE,eAAOA,UAAUC,SAAjB;AAA6B,OAAlE,CAAJ,EAAyE;AACvET,kBAAUU,QAAV,CAAmB,eAAnB,EAAoCR,UAApC;AACD;AACF;AACF,GAhBmD;;AAkBpDS,aAAW,mBAASC,IAAT,EAAe;AACxB,QAAIA,KAAKC,IAAL,KAAc,eAAlB,EAAmC;AACjC,WAAKZ,KAAL,GAAa;AACXE,0BAAkBW,WAAWF,KAAKV,UAAL,CAAgBC,gBAAhB,IAAoC,GAA/C,CADP;AAEXG,mBAAWQ,WAAWF,KAAKV,UAAL,CAAgB,iBAAhB,KAAsC,GAAjD,CAFA;AAGXE,yBAAiBW,SAASH,KAAKV,UAAL,CAAgBE,eAAhB,IAAmC,GAA5C,EAAiD,EAAjD,CAHN;AAIXC,yBAAiBU,SAASH,KAAKV,UAAL,CAAgBG,eAAhB,IAAmC,GAA5C,EAAiD,EAAjD;AAJN,OAAb;AAMA,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD,GA7BmD;AA8BpDW,aAAW,qBAAW,CACrB,CA/BmD;AAgCpDC,cAAY,sBAAW;AACrB,WAAO,KAAP;AACD;AAlCmD,CAAtD","file":"sheet-format-properties-xform.js","sourcesContent":["/**\n * Copyright (c) 2015 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar _ = require('../../../utils/under-dash');\nvar utils = require('../../../utils/utils');\nvar BaseXform = require('../base-xform');\n\nvar SheetFormatPropertiesXform = module.exports = function() {\n};\n\nutils.inherits(SheetFormatPropertiesXform, BaseXform, {\n\n  get tag() { return 'sheetFormatPr'; },\n\n  render: function(xmlStream, model) {\n    if (model) {\n      var attributes = {\n        defaultRowHeight: model.defaultRowHeight,\n        outlineLevelRow: model.outlineLevelRow,\n        outlineLevelCol: model.outlineLevelCol,\n        'x14ac:dyDescent': model.dyDescent\n      };\n      if (_.some(attributes, function(value) { return value !== undefined; })) {\n        xmlStream.leafNode('sheetFormatPr', attributes);\n      }\n    }\n  },\n  \n  parseOpen: function(node) {\n    if (node.name === 'sheetFormatPr') {\n      this.model = {\n        defaultRowHeight: parseFloat(node.attributes.defaultRowHeight || '0'),\n        dyDescent: parseFloat(node.attributes['x14ac:dyDescent'] || '0'),\n        outlineLevelRow: parseInt(node.attributes.outlineLevelRow || '0', 10),\n        outlineLevelCol: parseInt(node.attributes.outlineLevelCol || '0', 10),\n      };\n      return true;\n    }\n    return false;\n  },\n  parseText: function() {\n  },\n  parseClose: function() {\n    return false;\n  }\n});\n"]}