{"version":3,"sources":["../../../../../lib/xlsx/xform/book/workbook-view-xform.js"],"names":["utils","require","BaseXform","WorkbookViewXform","module","exports","inherits","render","xmlStream","model","attributes","xWindow","x","yWindow","y","windowWidth","width","windowHeight","height","firstSheet","activeTab","visibility","leafNode","parseOpen","node","name","addS","value","dflt","s","undefined","addN","n","parseInt","parseText","parseClose"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,QAAQC,QAAQ,sBAAR,CAAZ;AACA,IAAIC,YAAYD,QAAQ,eAAR,CAAhB;;AAEA,IAAIE,oBAAoBC,OAAOC,OAAP,GAAiB,YAAW,CACnD,CADD;;AAGAL,MAAMM,QAAN,CAAeH,iBAAf,EAAkCD,SAAlC,EAA6C;AAC3CK,UAAQ,gBAASC,SAAT,EAAoBC,KAApB,EAA2B;AACjC,QAAIC,aAAa;AACfC,eAASF,MAAMG,CAAN,IAAW,CADL;AAEfC,eAASJ,MAAMK,CAAN,IAAW,CAFL;AAGfC,mBAAaN,MAAMO,KAAN,IAAe,KAHb;AAIfC,oBAAcR,MAAMS,MAAN,IAAgB,KAJf;AAKfC,kBAAYV,MAAMU,UALH;AAMfC,iBAAWX,MAAMW;AANF,KAAjB;AAQA,QAAIX,MAAMY,UAAN,IAAoBZ,MAAMY,UAAN,KAAqB,SAA7C,EAAwD;AACtDX,iBAAWW,UAAX,GAAwBZ,MAAMY,UAA9B;AACD;AACDb,cAAUc,QAAV,CAAmB,cAAnB,EAAmCZ,UAAnC;AACD,GAd0C;;AAgB3Ca,aAAW,mBAASC,IAAT,EAAe;AACxB,QAAIA,KAAKC,IAAL,KAAc,cAAlB,EAAkC;AAChC,UAAIhB,QAAQ,KAAKA,KAAL,GAAa,EAAzB;AACA,UAAIiB,OAAO,SAAPA,IAAO,CAASD,IAAT,EAAeE,KAAf,EAAsBC,IAAtB,EAA4B;AACrC,YAAIC,IAAKF,UAAUG,SAAX,GAAwBrB,MAAMgB,IAAN,IAAcE,KAAtC,GAA8CC,IAAtD;AACA,YAAIC,MAAMC,SAAV,EAAqB;AACnBrB,gBAAMgB,IAAN,IAAcI,CAAd;AACD;AACF,OALD;AAMA,UAAIE,OAAO,SAAPA,IAAO,CAASN,IAAT,EAAeE,KAAf,EAAsBC,IAAtB,EAA4B;AACrC,YAAII,IAAKL,UAAUG,SAAX,GAAwBrB,MAAMgB,IAAN,IAAcQ,SAASN,KAAT,EAAgB,EAAhB,CAAtC,GAA4DC,IAApE;AACA,YAAII,MAAMF,SAAV,EAAqB;AACnBrB,gBAAMgB,IAAN,IAAcO,CAAd;AACD;AACF,OALD;AAMAD,WAAK,GAAL,EAAUP,KAAKd,UAAL,CAAgBC,OAA1B,EAAmC,CAAnC;AACAoB,WAAK,GAAL,EAAUP,KAAKd,UAAL,CAAgBG,OAA1B,EAAmC,CAAnC;AACAkB,WAAK,OAAL,EAAcP,KAAKd,UAAL,CAAgBK,WAA9B,EAA2C,KAA3C;AACAgB,WAAK,QAAL,EAAeP,KAAKd,UAAL,CAAgBO,YAA/B,EAA6C,KAA7C;AACAS,WAAK,YAAL,EAAmBF,KAAKd,UAAL,CAAgBW,UAAnC,EAA+C,SAA/C;AACAU,WAAK,WAAL,EAAkBP,KAAKd,UAAL,CAAgBU,SAAlC,EAA6CU,SAA7C;AACAC,WAAK,YAAL,EAAmBP,KAAKd,UAAL,CAAgBS,UAAnC,EAA+CW,SAA/C;AACA,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD,GAzC0C;AA0C3CI,aAAW,qBAAW,CACrB,CA3C0C;AA4C3CC,cAAY,sBAAW;AACrB,WAAO,KAAP;AACD;AA9C0C,CAA7C","file":"workbook-view-xform.js","sourcesContent":["/**\n * Copyright (c) 2016 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar utils = require('../../../utils/utils');\nvar BaseXform = require('../base-xform');\n\nvar WorkbookViewXform = module.exports = function() {\n};\n\nutils.inherits(WorkbookViewXform, BaseXform, {\n  render: function(xmlStream, model) {\n    var attributes = {\n      xWindow: model.x || 0,\n      yWindow: model.y || 0,\n      windowWidth: model.width || 12000,\n      windowHeight: model.height || 24000,\n      firstSheet: model.firstSheet,\n      activeTab: model.activeTab\n    };\n    if (model.visibility && model.visibility !== 'visible') {\n      attributes.visibility = model.visibility;\n    }\n    xmlStream.leafNode('workbookView', attributes);\n  },\n  \n  parseOpen: function(node) {\n    if (node.name === 'workbookView') {\n      var model = this.model = {};\n      var addS = function(name, value, dflt) {\n        var s = (value !== undefined) ? model[name] = value : dflt;\n        if (s !== undefined) {\n          model[name] = s;\n        }\n      };\n      var addN = function(name, value, dflt) {\n        var n = (value !== undefined) ? model[name] = parseInt(value, 10) : dflt;\n        if (n !== undefined) {\n          model[name] = n;\n        }\n      };\n      addN('x', node.attributes.xWindow, 0);\n      addN('y', node.attributes.yWindow, 0);\n      addN('width', node.attributes.windowWidth, 25000);\n      addN('height', node.attributes.windowHeight, 10000);\n      addS('visibility', node.attributes.visibility, 'visible');\n      addN('activeTab', node.attributes.activeTab, undefined);\n      addN('firstSheet', node.attributes.firstSheet, undefined);\n      return true;\n    }\n    return false;\n  },\n  parseText: function() {\n  },\n  parseClose: function() {\n    return false;\n  }\n});\n"]}