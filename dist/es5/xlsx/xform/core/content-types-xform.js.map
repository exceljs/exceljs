{"version":3,"sources":["../../../../../lib/xlsx/xform/core/content-types-xform.js"],"names":["utils","require","XmlStream","BaseXform","ContentTypesXform","module","exports","inherits","PROPERTY_ATTRIBUTES","xmlns","render","xmlStream","model","openXml","StdDocAttributes","openNode","mediaHash","media","forEach","medium","type","imageType","extension","leafNode","Extension","ContentType","PartName","worksheets","worksheet","name","id","hasSharedStrings","sharedStrings","count","drawings","drawing","closeNode","parseOpen","parseText","parseClose"],"mappings":"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","file":"content-types-xform.js","sourcesContent":["/**\n * Copyright (c) 2015 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar utils = require('../../../utils/utils');\nvar XmlStream = require('../../../utils/xml-stream');\n\nvar BaseXform = require('../base-xform');\n\n// used for rendering the [Content_Types].xml file\n// not used for parsing\nvar ContentTypesXform = module.exports = function() {\n};\n\n\nutils.inherits(ContentTypesXform, BaseXform, {\n  PROPERTY_ATTRIBUTES: {\n    xmlns: 'http://schemas.openxmlformats.org/package/2006/content-types'\n  }\n}, {\n\n  render: function(xmlStream, model) {\n    xmlStream.openXml(XmlStream.StdDocAttributes);\n\n    xmlStream.openNode('Types', ContentTypesXform.PROPERTY_ATTRIBUTES);\n\n    var mediaHash = {};\n    (model.media || []).forEach(function(medium) {\n      if (medium.type === 'image') {\n        var imageType = medium.extension;\n        if (!mediaHash[imageType]) {\n          mediaHash[imageType] = true;\n          xmlStream.leafNode('Default', {Extension: imageType, ContentType: 'image/' + imageType});\n        }\n      }\n    });\n\n    xmlStream.leafNode('Default', {Extension: 'rels', ContentType: 'application/vnd.openxmlformats-package.relationships+xml'});\n    xmlStream.leafNode('Default', {Extension: 'xml', ContentType: 'application/xml'});\n\n    xmlStream.leafNode('Override', {PartName: '/xl/workbook.xml', ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml'});\n\n    model.worksheets.forEach(function(worksheet) {\n      var name = '/xl/worksheets/sheet' + worksheet.id + '.xml';\n      xmlStream.leafNode('Override', {PartName: name, ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml'});\n    });\n\n    xmlStream.leafNode('Override', {PartName: '/xl/theme/theme1.xml',\n      ContentType: 'application/vnd.openxmlformats-officedocument.theme+xml'});\n    xmlStream.leafNode('Override', {PartName: '/xl/styles.xml',\n      ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml'});\n\n    var hasSharedStrings = model.sharedStrings && model.sharedStrings.count;\n    if (hasSharedStrings) {\n      xmlStream.leafNode('Override', {PartName: '/xl/sharedStrings.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml'});\n    }\n\n    model.drawings && model.drawings.forEach(function(drawing) {\n      xmlStream.leafNode('Override', {PartName: '/xl/drawings/' + drawing.name + '.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.drawing+xml'});\n    });\n\n    xmlStream.leafNode('Override', {PartName: '/docProps/core.xml',\n      ContentType: 'application/vnd.openxmlformats-package.core-properties+xml'});\n    xmlStream.leafNode('Override', {PartName: '/docProps/app.xml',\n      ContentType: 'application/vnd.openxmlformats-officedocument.extended-properties+xml'});\n\n    xmlStream.closeNode();\n  },\n\n  parseOpen: function() {\n    return false;\n  },\n  parseText: function() {\n  },\n  parseClose: function() {\n    return false;\n  }\n});\n"]}