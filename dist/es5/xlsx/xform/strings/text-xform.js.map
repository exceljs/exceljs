{"version":3,"sources":["../../../../../lib/xlsx/xform/strings/text-xform.js"],"names":["utils","require","BaseXform","TextXform","module","exports","inherits","tag","render","xmlStream","model","openNode","length","addAttribute","writeText","closeNode","_text","join","replace","$0","$1","String","fromCharCode","parseInt","parseOpen","node","name","parseText","text","push","parseClose"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,QAAQC,QAAQ,sBAAR,CAAZ;AACA,IAAIC,YAAYD,QAAQ,eAAR,CAAhB;;AAEA;;AAEA,IAAIE,YAAYC,OAAOC,OAAP,GAAiB,YAAW,CAC3C,CADD;;AAGAL,MAAMM,QAAN,CAAeH,SAAf,EAA0BD,SAA1B,EAAqC;;AAEnC,MAAIK,GAAJ,GAAU;AAAE,WAAO,GAAP;AAAa,GAFU;;AAInCC,UAAQ,gBAASC,SAAT,EAAoBC,KAApB,EAA2B;AACjCD,cAAUE,QAAV,CAAmB,GAAnB;AACA,QAAKD,MAAM,CAAN,MAAa,GAAd,IAAuBA,MAAMA,MAAME,MAAN,GAAe,CAArB,MAA4B,GAAvD,EAA6D;AAC3DH,gBAAUI,YAAV,CAAuB,WAAvB,EAAoC,UAApC;AACD;AACDJ,cAAUK,SAAV,CAAoBJ,KAApB;AACAD,cAAUM,SAAV;AACD,GAXkC;;AAanC,MAAIL,KAAJ,GAAY;AACV,WAAO,KAAKM,KAAL,CAAWC,IAAX,CAAgB,EAAhB,EAAoBC,OAApB,CAA4B,mBAA5B,EAAiD,UAASC,EAAT,EAAaC,EAAb,EAAiB;AACvE,aAAOC,OAAOC,YAAP,CAAoBC,SAASH,EAAT,EAAa,EAAb,CAApB,CAAP;AACD,KAFM,CAAP;AAGD,GAjBkC;;AAmBnCI,aAAW,mBAASC,IAAT,EAAe;AACxB,YAAQA,KAAKC,IAAb;AACE,WAAK,GAAL;AACE,aAAKV,KAAL,GAAa,EAAb;AACA,eAAO,IAAP;AACF;AACE,eAAO,KAAP;AALJ;AAOD,GA3BkC;AA4BnCW,aAAW,mBAASC,IAAT,EAAe;AACxB,SAAKZ,KAAL,CAAWa,IAAX,CAAgBD,IAAhB;AACD,GA9BkC;AA+BnCE,cAAY,sBAAW;AACrB,WAAO,KAAP;AACD;AAjCkC,CAArC","file":"text-xform.js","sourcesContent":["/**\n * Copyright (c) 2016 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar utils = require('../../../utils/utils');\nvar BaseXform = require('../base-xform');\n\n//   <t xml:space=\"preserve\"> is </t>\n\nvar TextXform = module.exports = function() {\n};\n\nutils.inherits(TextXform, BaseXform, {\n\n  get tag() { return 't'; },\n\n  render: function(xmlStream, model) {\n    xmlStream.openNode('t');\n    if ((model[0] === ' ') || (model[model.length - 1] === ' ')) {\n      xmlStream.addAttribute('xml:space', 'preserve');\n    }\n    xmlStream.writeText(model);\n    xmlStream.closeNode();\n  },\n  \n  get model() {\n    return this._text.join('').replace(/_x([0-9A-F]{4})_/g, function($0, $1) {\n      return String.fromCharCode(parseInt($1, 16));\n    });\n  },\n\n  parseOpen: function(node) {\n    switch (node.name) {\n      case 't':\n        this._text = [];\n        return true;\n      default:\n        return false;\n    }\n  },\n  parseText: function(text) {\n    this._text.push(text);\n  },\n  parseClose: function() {\n    return false;\n  }\n});\n"]}